---
phase: 07-final-packaging-a-delivery
plan: 04
type: execute
wave: 1
depends_on: []
files_modified:
  - design-system/style-dictionary.config.js
  - design-system/dist/tokens/package.json
  - design-system/dist/tokens/index.js
  - design-system/dist/tokens/index.cjs
  - design-system/dist/tokens/css/variables.css
  - design-system/dist/tokens/scss/variables.scss
  - design-system/dist/tokens/json/tokens.json
  - design-system/dist/tokens/README.md
  - design-system/package.json
autonomous: true
gap_closure: false

must_haves:
  truths:
    - "Developer can import design tokens into project via npm or direct include"
    - "Tokens available in CSS, SCSS, and JSON formats"
    - "Package supports both ESM (import) and CJS (require)"
    - "All design tokens from phases 1-5 are included"
  artifacts:
    - path: "design-system/dist/tokens/package.json"
      provides: "NPM package configuration with dual ESM/CJS exports"
    - path: "design-system/dist/tokens/css/variables.css"
      provides: "CSS custom properties"
    - path: "design-system/dist/tokens/scss/variables.scss"
      provides: "SCSS variables"
    - path: "design-system/dist/tokens/json/tokens.json"
      provides: "JSON token structure"
    - path: "design-system/dist/tokens/README.md"
      provides: "Developer installation and usage guide"
  key_links:
    - from: "design-system/dist/tokens/index.js"
      to: "design-system/dist/tokens/json/tokens.json"
      via: "JSON import"
      pattern: "import.*tokens\\.json"
---

<objective>
Create distributable design token package with dual ESM/CJS support for developers.

Purpose: Enable developers to import Hydrophon design tokens directly into their projects via npm install or direct file include, supporting all modern JavaScript environments.

Output:
- `dist/tokens/` - Complete token package directory
- `dist/tokens/package.json` - NPM package with exports field
- `dist/tokens/css/variables.css` - CSS custom properties
- `dist/tokens/scss/variables.scss` - SCSS variables
- `dist/tokens/json/tokens.json` - Nested JSON tokens
- `dist/tokens/index.js` + `index.cjs` - Dual ESM/CJS entry points
- `dist/tokens/README.md` - Developer documentation
</objective>

<execution_context>
@/Users/frederichille/.claude/get-shit-done/workflows/execute-plan.md
@/Users/frederichille/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/07-final-packaging-a-delivery/07-RESEARCH.md

# Existing configuration
@design-system/style-dictionary.config.js
@design-system/package.json
</context>

<tasks>

<task type="auto">
  <name>Task 1: Extend Style Dictionary config for distribution outputs</name>
  <files>
    - design-system/style-dictionary.config.js
    - design-system/package.json
  </files>
  <action>
1. Update `design-system/style-dictionary.config.js` to output to dist/tokens/:
   - Keep existing build/ outputs for development
   - Add new platforms for dist/tokens/:

   ```javascript
   export default {
     source: ['tokens/**/*.json'],
     platforms: {
       // Existing development outputs
       css: {
         transformGroup: 'css',
         buildPath: 'build/css/',
         files: [{
           destination: 'variables.css',
           format: 'css/variables',
           options: { outputReferences: true }
         }]
       },
       json: {
         transformGroup: 'js',
         buildPath: 'build/json/',
         files: [{
           destination: 'tokens.json',
           format: 'json/nested'
         }]
       },
       // Distribution outputs
       'dist-css': {
         transformGroup: 'css',
         buildPath: 'dist/tokens/css/',
         files: [{
           destination: 'variables.css',
           format: 'css/variables',
           options: { outputReferences: true }
         }]
       },
       'dist-scss': {
         transformGroup: 'scss',
         buildPath: 'dist/tokens/scss/',
         files: [{
           destination: 'variables.scss',
           format: 'scss/variables'
         }]
       },
       'dist-json': {
         transformGroup: 'js',
         buildPath: 'dist/tokens/json/',
         files: [{
           destination: 'tokens.json',
           format: 'json/nested'
         }]
       }
     }
   };
   ```

2. Update package.json build script to also create dist outputs:
   - Existing build command already runs Style Dictionary
   - The new platforms will be built automatically
  </action>
  <verify>
    - `design-system/style-dictionary.config.js` includes dist-css, dist-scss, dist-json platforms
    - Running `npm run build` creates files in both build/ and dist/tokens/
  </verify>
  <done>Style Dictionary configured to output distribution token files</done>
</task>

<task type="auto">
  <name>Task 2: Create NPM package structure with dual ESM/CJS support</name>
  <files>
    - design-system/dist/tokens/package.json
    - design-system/dist/tokens/index.js
    - design-system/dist/tokens/index.cjs
  </files>
  <action>
1. Create directory structure:
   ```bash
   mkdir -p design-system/dist/tokens
   ```

2. Run Style Dictionary to generate token files:
   ```bash
   cd design-system && npm run build
   ```

3. Create `design-system/dist/tokens/package.json`:
   ```json
   {
     "name": "@hydrophon/design-tokens",
     "version": "1.0.0",
     "description": "Hydrophon Design System Tokens - Farben, Typografie, Spacing und Komponenten-Tokens",
     "type": "module",
     "main": "./index.cjs",
     "module": "./index.js",
     "exports": {
       ".": {
         "import": "./index.js",
         "require": "./index.cjs"
       },
       "./css": "./css/variables.css",
       "./scss": "./scss/variables.scss",
       "./json": "./json/tokens.json"
     },
     "files": [
       "css/",
       "scss/",
       "json/",
       "index.js",
       "index.cjs",
       "README.md"
     ],
     "keywords": [
       "design-tokens",
       "design-system",
       "hydrophon",
       "css-variables",
       "scss"
     ],
     "author": "Hydrophon Kunststoff GmbH",
     "license": "UNLICENSED",
     "repository": {
       "type": "git",
       "url": "https://github.com/hydrophon/design-system"
     }
   }
   ```

4. Create `design-system/dist/tokens/index.js` (ESM):
   ```javascript
   // ESM entry point
   import tokens from './json/tokens.json' with { type: 'json' };
   export default tokens;
   export { tokens };
   ```

5. Create `design-system/dist/tokens/index.cjs` (CJS):
   ```javascript
   // CommonJS entry point
   const tokens = require('./json/tokens.json');
   module.exports = tokens;
   module.exports.default = tokens;
   ```
  </action>
  <verify>
    - `design-system/dist/tokens/package.json` exists with exports field
    - `design-system/dist/tokens/index.js` exists (ESM)
    - `design-system/dist/tokens/index.cjs` exists (CJS)
    - `design-system/dist/tokens/css/variables.css` exists
    - `design-system/dist/tokens/scss/variables.scss` exists
    - `design-system/dist/tokens/json/tokens.json` exists
  </verify>
  <done>NPM package supports both ESM and CJS imports</done>
</task>

<task type="auto">
  <name>Task 3: Create developer README for token package</name>
  <files>
    - design-system/dist/tokens/README.md
  </files>
  <action>
Create `design-system/dist/tokens/README.md` in German with:

1. Header: "# @hydrophon/design-tokens v1.0.0"

2. Installation section:
   ```bash
   # NPM
   npm install @hydrophon/design-tokens

   # Yarn
   yarn add @hydrophon/design-tokens

   # Direkte Einbindung (ohne npm)
   # Kopieren Sie den dist/tokens Ordner in Ihr Projekt
   ```

3. Verwendung section with code examples:

   **CSS Variables:**
   ```css
   /* Import alle CSS Custom Properties */
   @import '@hydrophon/design-tokens/css';

   /* Oder direkt einbinden */
   <link rel="stylesheet" href="node_modules/@hydrophon/design-tokens/css/variables.css">

   /* Verwendung */
   .button {
     background-color: var(--hydrophon-blau-500);
     padding: var(--spacing-3) var(--spacing-4);
   }
   ```

   **SCSS:**
   ```scss
   // Import SCSS Variables
   @use '@hydrophon/design-tokens/scss' as tokens;

   .button {
     background-color: tokens.$hydrophon-blau-500;
     padding: tokens.$spacing-3 tokens.$spacing-4;
   }
   ```

   **JavaScript (ESM):**
   ```javascript
   import tokens from '@hydrophon/design-tokens';
   // oder
   import { tokens } from '@hydrophon/design-tokens';

   console.log(tokens.hydrophon.blau[500].value); // '#008bd2'
   ```

   **JavaScript (CommonJS):**
   ```javascript
   const tokens = require('@hydrophon/design-tokens');

   console.log(tokens.hydrophon.blau[500].value);
   ```

4. Enthaltene Tokens section with table:
   | Kategorie | Anzahl | Beschreibung |
   |-----------|--------|--------------|
   | Farben | ~60 | Markenfarben, Graustufen, Semantische Farben |
   | Typografie | ~30 | Schriftfamilien, Groessen, Gewichte, Zeilenhoehen |
   | Spacing | ~15 | Abstaende basierend auf 4px Basis |
   | Effekte | ~20 | Border-Radius, Schatten, Uebergaenge |
   | Buttons | ~50 | Button-Varianten und Zustaende |
   | Forms | ~100+ | Input, Checkbox, Radio, Validation |
   | Navigation | ~50 | Header, Footer, Breadcrumb |
   | Feedback | ~50 | Modal, Tooltip, Toast, Loading |

5. Token-Struktur section explaining W3C DTCG format

6. Updates section: Wie man auf neue Versionen aktualisiert

7. Version and link to full documentation
  </action>
  <verify>
    - File `design-system/dist/tokens/README.md` exists
    - README includes installation, usage examples (CSS, SCSS, ESM, CJS)
    - Token categories are documented
    - Content is in German
  </verify>
  <done>Developer README provides clear installation and usage instructions</done>
</task>

</tasks>

<verification>
1. `npm run build` creates files in dist/tokens/ (CSS, SCSS, JSON)
2. package.json has valid exports field
3. ESM import works: `import tokens from './index.js'`
4. CJS require works: `const tokens = require('./index.cjs')`
5. README has clear installation and usage examples
</verification>

<success_criteria>
- Developer can import CSS: `@import '@hydrophon/design-tokens/css'`
- Developer can import SCSS: `@use '@hydrophon/design-tokens/scss'`
- Developer can import JS (ESM): `import tokens from '@hydrophon/design-tokens'`
- Developer can require JS (CJS): `require('@hydrophon/design-tokens')`
- All tokens from phases 1-5 are included (colors, typography, spacing, effects, buttons, forms, navigation, feedback)
- Package is ready for npm publish (though not published yet)
</success_criteria>

<output>
After completion, create `.planning/phases/07-final-packaging-a-delivery/07-04-SUMMARY.md`
</output>
