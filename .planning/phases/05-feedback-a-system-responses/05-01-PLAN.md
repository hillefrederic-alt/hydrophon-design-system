---
phase: 05-feedback-a-system-responses
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - design-system/tokens/feedback.json
  - design-system/docs/feedback/modal.md
autonomous: true

must_haves:
  truths:
    - "Developer can implement modal with three size variants (small, medium, large)"
    - "Modal closes via ESC key and close button"
    - "Focus is trapped inside modal when open"
    - "Modal has proper ARIA attributes for screen readers"
  artifacts:
    - path: "design-system/tokens/feedback.json"
      provides: "Modal tokens (sizes, overlay, spacing, animation)"
      contains: "modal"
    - path: "design-system/docs/feedback/modal.md"
      provides: "Modal component documentation in German"
      min_lines: 400
  key_links:
    - from: "design-system/docs/feedback/modal.md"
      to: "design-system/tokens/feedback.json"
      via: "Token references in documentation"
      pattern: "--modal"
---

<objective>
Create modal/dialog token system and comprehensive German documentation covering size variants, accessibility requirements, and implementation patterns.

Purpose: Modals are essential for confirmations, forms, and focused content. This plan establishes the token foundation and documentation for accessible, consistent modal implementations.

Output: feedback.json with modal tokens, modal.md documentation with all variants and accessibility patterns
</objective>

<execution_context>
@/Users/frederichille/.claude/get-shit-done/workflows/execute-plan.md
@/Users/frederichille/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/05-feedback-a-system-responses/05-CONTEXT.md
@.planning/phases/05-feedback-a-system-responses/05-RESEARCH.md
@design-system/tokens/navigation.json
@design-system/docs/navigation/mobile-drawer.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create modal token system in feedback.json</name>
  <files>design-system/tokens/feedback.json</files>
  <action>
Create new feedback.json token file following W3C DTCG format with $value and $type.

Structure the modal tokens:
```json
{
  "modal": {
    "overlay": {
      "background": { "$value": "rgba(0, 0, 0, 0.5)", "$type": "color" },
      "blur": { "$value": "4px", "$type": "dimension" }
    },
    "content": {
      "background": { "$value": "{color.neutral.white}", "$type": "color" },
      "border-radius": { "$value": "{radius.lg}", "$type": "dimension" },
      "shadow": { "$value": "{shadow.xl}", "$type": "shadow" },
      "padding": {
        "x": { "$value": "{spacing.6}", "$type": "dimension" },
        "y": { "$value": "{spacing.5}", "$type": "dimension" }
      }
    },
    "size": {
      "sm": {
        "width": { "$value": "400px", "$type": "dimension" },
        "max-height": { "$value": "80vh", "$type": "dimension" }
      },
      "md": {
        "width": { "$value": "600px", "$type": "dimension" },
        "max-height": { "$value": "85vh", "$type": "dimension" }
      },
      "lg": {
        "width": { "$value": "900px", "$type": "dimension" },
        "max-height": { "$value": "90vh", "$type": "dimension" }
      }
    },
    "header": {
      "padding-bottom": { "$value": "{spacing.4}", "$type": "dimension" },
      "border-bottom": { "$value": "1px solid {color.neutral.200}", "$type": "border" }
    },
    "title": {
      "font-size": { "$value": "{typography.heading.h4.fontSize}", "$type": "dimension" },
      "font-weight": { "$value": "{typography.heading.h4.fontWeight}", "$type": "fontWeight" },
      "color": { "$value": "{color.neutral.900}", "$type": "color" }
    },
    "close-button": {
      "size": { "$value": "32px", "$type": "dimension" },
      "icon-size": { "$value": "20px", "$type": "dimension" },
      "color": { "$value": "{color.neutral.500}", "$type": "color" },
      "hover-color": { "$value": "{color.neutral.700}", "$type": "color" },
      "hover-background": { "$value": "{color.neutral.100}", "$type": "color" },
      "border-radius": { "$value": "{radius.md}", "$type": "dimension" }
    },
    "body": {
      "padding-y": { "$value": "{spacing.4}", "$type": "dimension" },
      "color": { "$value": "{color.neutral.700}", "$type": "color" }
    },
    "footer": {
      "padding-top": { "$value": "{spacing.4}", "$type": "dimension" },
      "border-top": { "$value": "1px solid {color.neutral.200}", "$type": "border" },
      "gap": { "$value": "{spacing.3}", "$type": "dimension" }
    },
    "animation": {
      "duration": { "$value": "200ms", "$type": "duration" },
      "timing": { "$value": "ease-out", "$type": "cubicBezier" }
    },
    "z-index": { "$value": "1000", "$type": "number" }
  }
}
```

Reference existing spacing, color, typography, and effects tokens. Use 400px/600px/900px for small/medium/large widths (aligning with CONTEXT.md size system and Phase 4 card patterns).

Include overlay with semi-transparent black and optional backdrop blur for modern aesthetic.
  </action>
  <verify>
Run Style Dictionary build: `cd design-system && npm run build`
Check that modal CSS variables appear in build/css/variables.css
Verify JSON is valid: `node -e "require('./design-system/tokens/feedback.json')"`
  </verify>
  <done>
feedback.json exists with modal token structure, Style Dictionary builds without errors, CSS variables include --modal-* properties
  </done>
</task>

<task type="auto">
  <name>Task 2: Create modal documentation in German</name>
  <files>design-system/docs/feedback/modal.md</files>
  <action>
Create comprehensive modal documentation following the established pattern from mobile-drawer.md and other component docs.

Structure:
1. **Uebersicht** - What modals are, when to use them
2. **Varianten** - Small (confirmations), Medium (forms), Large (complex content)
3. **Anatomie** - Overlay, container, header, title, close button, body, footer
4. **Design-Token** - Reference all modal tokens from feedback.json with CSS variable names
5. **Verhalten**
   - Oeffnen/Schliessen (ESC key, close button, NO backdrop click per CONTEXT.md)
   - Focus-Management (trap focus inside, return to trigger on close)
   - Animation (fade + scale per RESEARCH.md recommendation)
6. **Barrierefreiheit (WCAG 2.1 AA)**
   - role="dialog" and aria-modal="true"
   - aria-labelledby pointing to title
   - aria-describedby for description (optional)
   - Focus trap implementation (reference Phase 4 mobile-drawer pattern)
   - ESC key closes per WCAG 2.1.2
7. **Bestaetigung-Dialoge** - Special pattern for destructive actions
   - Explicit Cancel button required
   - Destructive action button uses color.error
   - Clear, specific action text (not "OK/Cancel")
8. **Formular-Dialoge** - Forms in modals
   - Form validation before close
   - Unsaved changes warning pattern
9. **Technische Referenz**
   - Radix UI Dialog recommendation from RESEARCH.md
   - Code examples with React/JSX
   - Portal rendering explanation
10. **Anti-Patterns** - What to avoid
    - Modal overuse
    - Backdrop click dismissal
    - Critical info in modals

Include code examples with proper German comments. Reference established patterns from Phase 4 mobile-drawer for focus management.
  </action>
  <verify>
File exists at design-system/docs/feedback/modal.md
File is at least 400 lines (comprehensive documentation)
Contains German headings (Uebersicht, Varianten, Barrierefreiheit)
References modal tokens from feedback.json
  </verify>
  <done>
modal.md documentation complete with all sections, German language, WCAG compliance details, code examples, and anti-patterns
  </done>
</task>

</tasks>

<verification>
1. feedback.json contains valid modal tokens in W3C DTCG format
2. Style Dictionary builds successfully with new feedback tokens
3. modal.md documentation is comprehensive (400+ lines)
4. All three size variants documented (small, medium, large)
5. Accessibility requirements clearly specified (focus trap, ARIA, ESC key)
6. References established patterns from Phase 4 mobile-drawer
</verification>

<success_criteria>
- Modal token system complete with size variants, overlay, animation
- German documentation covers all use cases (confirmation, form, content)
- WCAG 2.1 AA accessibility patterns documented
- Radix UI Dialog recommended per RESEARCH.md
- Style Dictionary build produces CSS custom properties
</success_criteria>

<output>
After completion, create `.planning/phases/05-feedback-a-system-responses/05-01-SUMMARY.md`
</output>
