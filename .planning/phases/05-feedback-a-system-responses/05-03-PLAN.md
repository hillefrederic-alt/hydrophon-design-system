---
phase: 05-feedback-a-system-responses
plan: 03
type: execute
wave: 1
depends_on: []
files_modified:
  - design-system/tokens/feedback.json
  - design-system/docs/feedback/loading.md
  - design-system/docs/feedback/index.md
autonomous: true

must_haves:
  truths:
    - "Developer can choose appropriate loading indicator for context (spinner, progress, skeleton)"
    - "Spinner appears after 200-300ms delay to avoid flash"
    - "Progress bar shows determinate progress for known-duration tasks"
    - "Skeleton screens match content layout to prevent layout shift"
    - "Loading states support prefers-reduced-motion"
  artifacts:
    - path: "design-system/tokens/feedback.json"
      provides: "Loading state tokens (spinner, progress, skeleton)"
      contains: "spinner"
    - path: "design-system/docs/feedback/loading.md"
      provides: "Loading states documentation in German"
      min_lines: 400
    - path: "design-system/docs/feedback/index.md"
      provides: "Feedback section index page"
      min_lines: 100
  key_links:
    - from: "design-system/docs/feedback/loading.md"
      to: "design-system/tokens/feedback.json"
      via: "Token references"
      pattern: "--spinner|--progress|--skeleton"
    - from: "design-system/docs/feedback/index.md"
      to: "design-system/docs/feedback/*.md"
      via: "Navigation links"
      pattern: "modal|tooltip|toast|loading"
---

<objective>
Create loading state token system (spinner, progress bar, skeleton screens) with comprehensive German documentation, plus a feedback section index page linking all Phase 5 components.

Purpose: Loading indicators maintain user confidence during async operations. This plan covers the full spectrum: quick-action spinners, long-task progress bars, and content-loading skeletons.

Output: Loading tokens in feedback.json, loading.md documentation, index.md for feedback section navigation
</objective>

<execution_context>
@/Users/frederichille/.claude/get-shit-done/workflows/execute-plan.md
@/Users/frederichille/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/05-feedback-a-system-responses/05-CONTEXT.md
@.planning/phases/05-feedback-a-system-responses/05-RESEARCH.md
@design-system/docs/forms/index.md
@design-system/docs/navigation/index.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Add loading state tokens to feedback.json</name>
  <files>design-system/tokens/feedback.json</files>
  <action>
Extend feedback.json with spinner, progress bar, and skeleton tokens. If prior plans haven't run, create the complete feedback.json.

Add spinner tokens:
```json
{
  "spinner": {
    "size": {
      "sm": { "$value": "16px", "$type": "dimension" },
      "md": { "$value": "24px", "$type": "dimension" },
      "lg": { "$value": "32px", "$type": "dimension" },
      "xl": { "$value": "48px", "$type": "dimension" }
    },
    "stroke-width": { "$value": "2px", "$type": "dimension" },
    "color": {
      "primary": { "$value": "{color.hydrophon.blau.500}", "$type": "color" },
      "light": { "$value": "{color.neutral.400}", "$type": "color" },
      "on-primary": { "$value": "{color.neutral.white}", "$type": "color" }
    },
    "track-color": { "$value": "{color.neutral.200}", "$type": "color" },
    "animation": {
      "duration": { "$value": "750ms", "$type": "duration" },
      "timing": { "$value": "linear", "$type": "cubicBezier" }
    },
    "delay": { "$value": "200ms", "$type": "duration", "$description": "Delay before showing to avoid flash" }
  }
}
```

Add progress bar tokens:
```json
{
  "progress": {
    "height": { "$value": "8px", "$type": "dimension" },
    "height-sm": { "$value": "4px", "$type": "dimension" },
    "border-radius": { "$value": "{radius.full}", "$type": "dimension" },
    "track": {
      "background": { "$value": "{color.neutral.200}", "$type": "color" }
    },
    "bar": {
      "background": { "$value": "{color.hydrophon.blau.500}", "$type": "color" },
      "success": { "$value": "{color.success.500}", "$type": "color" }
    },
    "indeterminate": {
      "animation-duration": { "$value": "1.5s", "$type": "duration" }
    },
    "label": {
      "font-size": { "$value": "{typography.body.sm.fontSize}", "$type": "dimension" },
      "color": { "$value": "{color.neutral.600}", "$type": "color" },
      "gap": { "$value": "{spacing.2}", "$type": "dimension" }
    }
  }
}
```

Add skeleton tokens:
```json
{
  "skeleton": {
    "base-color": { "$value": "{color.neutral.200}", "$type": "color" },
    "highlight-color": { "$value": "{color.neutral.100}", "$type": "color" },
    "border-radius": { "$value": "{radius.md}", "$type": "dimension" },
    "animation": {
      "duration": { "$value": "1.5s", "$type": "duration" },
      "timing": { "$value": "ease-in-out", "$type": "cubicBezier" }
    },
    "line-height": { "$value": "1.2", "$type": "number" },
    "spacing": { "$value": "{spacing.2}", "$type": "dimension" }
  }
}
```

Spinner sizes align with icon sizes from Phase 2. Progress bar uses brand blue. Skeleton uses neutral colors for shimmer effect.
  </action>
  <verify>
Run Style Dictionary build: `cd design-system && npm run build`
Check CSS output includes --spinner-*, --progress-*, --skeleton-* variables
Verify JSON is valid: `node -e "require('./design-system/tokens/feedback.json')"`
  </verify>
  <done>
feedback.json contains spinner, progress, and skeleton tokens, Style Dictionary builds successfully, all CSS variables generated
  </done>
</task>

<task type="auto">
  <name>Task 2: Create loading documentation and feedback index</name>
  <files>
    design-system/docs/feedback/loading.md
    design-system/docs/feedback/index.md
  </files>
  <action>
Create two documentation files.

**loading.md** (400+ lines):
1. **Uebersicht** - Loading states maintain user confidence during async operations
2. **Wann welchen Indikator verwenden**
   - Spinner: Quick actions (<3 Sekunden)
   - Progress Bar: Long tasks with known duration (uploads, file processing)
   - Skeleton: Content loading (cards, tables, lists)
3. **Spinner**
   - Sizes (sm 16px, md 24px, lg 32px, xl 48px)
   - Colors (primary, light, on-primary)
   - Delayed appearance (200-300ms) to avoid flash (CONTEXT.md)
   - CSS animation (@keyframes spin)
   - Accessibility (aria-label="Wird geladen")
4. **Progress Bar**
   - Determinate vs Indeterminate
   - Native <progress> element recommendation
   - Label with percentage
   - Success state on completion
   - Accessibility (aria-valuenow, aria-valuemin, aria-valuemax)
5. **Skeleton Screens**
   - Match final content layout exactly
   - react-loading-skeleton recommendation (RESEARCH.md)
   - Card skeleton pattern
   - Table skeleton pattern
   - Shimmer animation (GPU-accelerated)
6. **Optimistic UI** (CONTEXT.md)
   - What it is (show success immediately)
   - When to use (like, save, favorite)
   - When NOT to use (destructive actions, critical operations)
   - React useOptimistic hook pattern
   - Rollback on error with toast
7. **Fehlerbehandlung** - Error toast + retry action (CONTEXT.md)
8. **Barrierefreiheit**
   - prefers-reduced-motion: reduce
   - aria-busy="true" on loading containers
   - Live region announcements
9. **Code-Beispiele**
   - DelayedSpinner component
   - ProgressBar with percentage
   - ProductCardSkeleton
   - Optimistic update pattern
10. **Anti-Patterns**
    - Spinner flash for fast operations
    - Hardcoded skeleton dimensions
    - Optimistic UI for destructive actions

**index.md** (100+ lines):
Create feedback section index following pattern from forms/index.md and navigation/index.md.

Structure:
1. **Feedback & Systemrueckmeldungen** - Section title
2. **Uebersicht** - What this section covers
3. **Komponenten**
   - Modal-Dialoge (link to modal.md) - Confirmations, forms, focused content
   - Tooltips (link to tooltip.md) - Short contextual labels
   - Toast-Benachrichtigungen (link to toast.md) - Action confirmations
   - Ladezustaende (link to loading.md) - Spinner, progress, skeleton
4. **Wann welche Komponente**
   - Decision table: Use case -> Component
5. **Gemeinsame Prinzipien**
   - Non-intrusive feedback
   - Accessibility first
   - Consistent timing and animation

All in German with proper formatting.
  </action>
  <verify>
Files exist at design-system/docs/feedback/loading.md and index.md
loading.md is at least 400 lines
index.md is at least 100 lines
index.md links to all four feedback components
Contains prefers-reduced-motion documentation
  </verify>
  <done>
loading.md complete with spinner, progress bar, skeleton documentation and optimistic UI patterns. index.md provides navigation to all Phase 5 components.
  </done>
</task>

</tasks>

<verification>
1. feedback.json contains complete token system (modal, tooltip, toast, spinner, progress, skeleton)
2. Spinner delay token is 200ms per UX best practice
3. Loading patterns cover all three contexts (quick, long, content)
4. Optimistic UI pattern documented with appropriate use cases
5. prefers-reduced-motion accessibility documented
6. index.md links to all four feedback component docs
7. Style Dictionary builds successfully with all tokens
</verification>

<success_criteria>
- Loading tokens complete (spinner sizes, progress colors, skeleton animation)
- loading.md covers all three indicator types with use-case guidance
- Optimistic UI documented per CONTEXT.md
- Error handling pattern (toast + retry) documented
- index.md serves as navigation hub for feedback section
- All accessibility requirements documented (ARIA, reduced motion)
</success_criteria>

<output>
After completion, create `.planning/phases/05-feedback-a-system-responses/05-03-SUMMARY.md`
</output>
