---
phase: 01-foundation-brand-identity
plan: 05
type: execute
wave: 2
depends_on: ["01-01", "01-02", "01-03"]
files_modified:
  - design-system/tokens/tokens.json
  - design-system/build/css/variables.css
  - design-system/build/json/tokens.json
  - style-dictionary.config.js
  - package.json
autonomous: true

must_haves:
  truths:
    - "Developer can import design tokens as CSS variables"
    - "Developer can import design tokens as JSON"
    - "Token build process runs without errors"
    - "All color, typography, spacing, and effect tokens are included in output"
  artifacts:
    - path: "design-system/tokens/tokens.json"
      provides: "Consolidated W3C DTCG token file"
      contains: "color"
    - path: "design-system/build/css/variables.css"
      provides: "CSS custom properties generated from tokens"
      contains: "--color-primary"
    - path: "design-system/build/json/tokens.json"
      provides: "JSON tokens for JavaScript consumption"
      contains: "color"
    - path: "style-dictionary.config.js"
      provides: "Style Dictionary build configuration"
      min_lines: 20
  key_links:
    - from: "design-system/build/css/variables.css"
      to: "design-system/tokens/"
      via: "Style Dictionary transforms tokens to CSS"
    - from: "design-system/build/json/tokens.json"
      to: "design-system/tokens/"
      via: "Style Dictionary transforms tokens to JSON"
---

<objective>
Consolidate all design tokens and set up Style Dictionary build process to generate CSS and JSON outputs.

Purpose: Enable developers to consume design tokens in their preferred format, creating a single source of truth that syncs with both design and development workflows.

Output:
- Consolidated tokens.json file
- Style Dictionary configuration
- Generated CSS variables
- Generated JSON for JavaScript
</objective>

<execution_context>
@/Users/frederichille/.claude/get-shit-done/workflows/execute-plan.md
@/Users/frederichille/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md

Depends on completed plans:
@.planning/phases/01-foundation-brand-identity/01-01-SUMMARY.md (colors)
@.planning/phases/01-foundation-brand-identity/01-02-SUMMARY.md (typography)
@.planning/phases/01-foundation-brand-identity/01-03-SUMMARY.md (spacing, effects)

Requirements from ROADMAP:
- FOUND-01: Design Token System etabliert (Style Dictionary)
- Success Criteria #3: Developer can access design tokens as CSS/JSON variables

Research context:
- Stack: Style Dictionary 4.0 with W3C DTCG standard
- 3-tier token architecture: primitive → semantic → component
</context>

<tasks>

<task type="auto">
  <name>Task 1: Initialize npm project and install Style Dictionary</name>
  <files>package.json</files>
  <action>
Initialize npm project (if not exists) and install Style Dictionary 4.0.

```bash
cd design-system
npm init -y
npm install style-dictionary@4
```

Update package.json with build script:
```json
{
  "name": "hydrophon-design-system",
  "version": "1.0.0",
  "description": "Hydrophon Design System Tokens",
  "scripts": {
    "build": "style-dictionary build",
    "build:watch": "style-dictionary build --watch"
  },
  "devDependencies": {
    "style-dictionary": "^4.0.0"
  }
}
```
  </action>
  <verify>npm install completes, package.json has style-dictionary dependency</verify>
  <done>Style Dictionary is installed and build script is configured</done>
</task>

<task type="auto">
  <name>Task 2: Consolidate tokens and create Style Dictionary config</name>
  <files>design-system/tokens/tokens.json, style-dictionary.config.js</files>
  <action>
**Step 1: Create consolidated tokens.json**

Merge all token files (colors.json, typography.json, spacing.json, effects.json) into a single tokens.json file, maintaining the W3C DTCG structure.

Structure:
```json
{
  "$type": "...",
  "color": { /* from colors.json */ },
  "typography": { /* from typography.json */ },
  "spacing": { /* from spacing.json */ },
  "borderRadius": { /* from effects.json */ },
  "shadow": { /* from effects.json */ },
  "breakpoint": { /* from spacing.json */ },
  "grid": { /* from spacing.json */ }
}
```

Alternatively, Style Dictionary 4.0 supports importing multiple files via glob patterns.

**Step 2: Create Style Dictionary configuration**

Create `style-dictionary.config.js` in project root:

```javascript
import StyleDictionary from 'style-dictionary';

export default {
  source: ['design-system/tokens/**/*.json'],
  platforms: {
    css: {
      transformGroup: 'css',
      buildPath: 'design-system/build/css/',
      files: [
        {
          destination: 'variables.css',
          format: 'css/variables',
          options: {
            outputReferences: true
          }
        }
      ]
    },
    json: {
      transformGroup: 'js',
      buildPath: 'design-system/build/json/',
      files: [
        {
          destination: 'tokens.json',
          format: 'json/nested'
        }
      ]
    }
  }
};
```

Configure for W3C DTCG format parsing (Style Dictionary 4.0 supports this natively).
  </action>
  <verify>style-dictionary.config.js exists and is valid JavaScript module</verify>
  <done>Token consolidation and Style Dictionary configuration complete</done>
</task>

<task type="auto">
  <name>Task 3: Run build and verify outputs</name>
  <files>design-system/build/css/variables.css, design-system/build/json/tokens.json</files>
  <action>
Run Style Dictionary build process:

```bash
cd design-system
npm run build
```

**Verify CSS output (variables.css):**
- Should contain CSS custom properties like:
  - `--color-primary: #008BD2;`
  - `--color-success: #22C55E;`
  - `--font-size-base: 16px;`
  - `--spacing-4: 16px;`
  - `--border-radius-base: 4px;`
  - `--shadow-base: ...;`

**Verify JSON output (tokens.json):**
- Should contain nested object structure
- All token categories present (color, typography, spacing, etc.)
- Values resolved (no references in output)

If build fails:
- Check token JSON syntax
- Verify W3C DTCG $value/$type syntax
- Check config file module syntax
  </action>
  <verify>npm run build succeeds, variables.css and tokens.json are generated</verify>
  <done>Design tokens build successfully into CSS and JSON formats</done>
</task>

</tasks>

<verification>
- [ ] package.json exists with style-dictionary dependency
- [ ] npm run build completes without errors
- [ ] design-system/build/css/variables.css exists and contains CSS custom properties
- [ ] design-system/build/json/tokens.json exists and contains nested tokens
- [ ] All color tokens appear in output
- [ ] All typography tokens appear in output
- [ ] All spacing tokens appear in output
- [ ] All effect tokens (borderRadius, shadow) appear in output
- [ ] FOUND-01 requirement satisfied: Design Token System is operational
</verification>

<success_criteria>
Developer can run `npm run build` and get fresh CSS variables and JSON tokens.
Developer can import `variables.css` into a web project.
Developer can import `tokens.json` into a JavaScript project.
Design tokens are the single source of truth for all visual properties.
</success_criteria>

<output>
After completion, create `.planning/phases/01-foundation-brand-identity/01-05-SUMMARY.md`
</output>
